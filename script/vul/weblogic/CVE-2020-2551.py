#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @author: orleven

from lib.util.aiohttputil import open_connection
from lib.core.enums import ServicePortMap
from script import BaseScript

class Script(BaseScript):

    def __init__(self):
        BaseScript.__init__(self)
        self.service_type = ServicePortMap.WEBLOGIC

    async def prove(self):
        try:
            reader, writer = await open_connection(self.host, self.port)
            writer.write(bytes.fromhex('47494f50010200030000001700000002000000000000000b4e616d6553657276696365'))
            data = await reader.read(1024)
            if b'GIOP' in data:
                yield "CVE-2020-2551"
        except:
            pass
